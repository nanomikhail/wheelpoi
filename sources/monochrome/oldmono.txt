#ifndef F_CPU
#define F_CPU 8000000UL
#endif

#include <avr/io.h>
#include <util/delay.h>

//======================================Initialize 74HC595======================================//

#define HC595_PORT   PORTB
#define HC595_DDR    DDRB
#define HC595_DS_POS PB0		 //Data pin (DS) pin location
#define HC595_SH_CP_POS PB2      //Shift Clock (SH_CP) pin location
#define HC595_ST_CP_POS PB1      //Store Clock (ST_CP) pin location

void HC595Init(){HC595_DDR|=((1<<HC595_SH_CP_POS)|(1<<HC595_ST_CP_POS)|(1<<HC595_DS_POS));}

#define HC595DataHigh() (HC595_PORT|=(1<<HC595_DS_POS))
#define HC595DataLow() (HC595_PORT&=(~(1<<HC595_DS_POS)))

void HC595Pulse(){
	HC595_PORT|=(1<<HC595_SH_CP_POS);
	HC595_PORT&=(~(1<<HC595_SH_CP_POS));
}

void HC595Latch(){
	HC595_PORT|=(1<<HC595_ST_CP_POS);
	_delay_loop_1(1);
	HC595_PORT&=(~(1<<HC595_ST_CP_POS));
	_delay_loop_1(1);
}

void HC595Write(int data){
	for(int i=0;i<16;i++){
		if(data & 0b10000000000000000){
			HC595DataLow();
			}else{
			HC595DataHigh();
		}
		HC595Pulse();
		data=data<<1;
	}
	HC595Latch();
}

//======================================Initialize 74HC595======================================//

int main(){
	HC595Init();
	long int imagee = 0b0000000000000000;

	unsigned int image[10][16]={
		{0b0011111111111110,0b1001111111111100,0b1100111111111001,0b1110011111110011,0b1111001111100111,0b1111100111001111,0b1111110011011111,0b1111111001111111,0b1111111100111111,0b1111110110011111,0b1111100111001111,0b1111001111100111,0b1110011111110011,0b1100111111111001,0b1001111111111100,0b0011111111111110},
		{0b0000001100000011,0b0000001100000011,0b0000011000000110,0b0000011000000110,0b0000110000001100,0b0000110000001100,0b0001100000011000,0b0001100000011000,0b0011000000110000,0b0011000000110000,0b0110000001100000,0b0110000001100000,0b1100000011000000,0b1100000011000000,0b1000000110000001,0b1000000110000001},
		{0b0000000000000000,0b0000000000000000,0b0000001010000000,0b0000001110000000,0b0000001110000000,0b0000001110000000,0b0000001110000000,0b0000001110000000,0b0000001110000000,0b0000001110000000,0b0000001110000000,0b0001111111110000,0b0000111111100000,0b0000011111000000,0b0000001110000000,0b0000000100000000},
		{0b1000000000000001,0b0100000000000010,0b0010000000000100,0b0001000000001000,0b0000100000010000,0b0000010000100000,0b0000001001000000,0b0000000100000000,0b0000000010000000,0b0000001001000000,0b0000010000100000,0b0000100000010000,0b0001000000001000,0b0010100000000100,0b0101000000000010,0b1010000000000001},
		{0b0011000000000000,0b0111100000000000,0b0111110000000000,0b0011111000000000,0b0111110000000000,0b0111100000000000,0b0011000000000000,0b0000000011000000,0b0000000111100000,0b0000000111110000,0b0000000011111000,0b0000000111110000,0b0000000111100000,0b0000000011000000,0b0000000000000000,0b0000000000000000},
		{0b1111000000000000,0b1111000000000000,0b1111000000000000,0b1111000000000000,0b0000111100000000,0b0000111100000000,0b0000111100000000,0b0000111100000000,0b0000000011110000,0b0000000011110000,0b0000000011110000,0b0000000011110000,0b0000000000001111,0b0000000000001111,0b0000000000001111,0b0000000000001111},
		{0b1000000000000001,0b1001000001001001,0b1000001000000001,0b1000000000000001,0b1010000000001001,0b1000000001000001,0b1000100000000101,0b1000000000000001,0b1000001000100001,0b1000000000000101,0b1010000000000001,0b1000010000000001,0b1000000010001001,0b1000000000000001,0b1000000001000001,0b1000001000000101},
		{0b0000000000011111,0b0000000001111111,0b0000000011111111,0b0000001111111111,0b0000011111111111,0b0001111111111111,0b0111111111111111,0b1111111111111111,0b1111111111111111,0b0111111111111111,0b0001111111111111,0b0000011111111111,0b0000001111111111,0b0000000011111111,0b0000000001111111,0b0000000000011111},
		{0b0000000000000011,
			0b0000000110000011,
			0b0000001110000111,
			0b0000001100000111,
			0b0000001100001111,
			0b0000000110001111,
			0b0000000111111111,
			0b0000000011111111,
			0b0000000001111111,
			0b0000000000011111,
			0b0000000000001111,
			0b0000000000001111,
			0b0000000000000111,
			0b0000000000000011,
			0b0000000000000011,
		0b0000000000000011},

		{0b1000000000000001,
			0b1100000000000001,
			0b1111111111100001,
			0b1111111111111001,
			0b1111111111111001,
			0b1111111111100001,
			0b1100000000000001,
			0b1000000000000001,
			0b1000000000000001,
			0b1000000000000011,
			0b1000011111111111,
			0b1001111111111111,
			0b1001111111111111,
			0b1000011111111111,
			0b1000000000000011,
		0b1000000000000001}
		
	};


	while(1){
		for (int j=0;j<10;j++){
			for (int k=0;k<200;k++){
				for(int i=0;i<16;i++){
					HC595Write(image[j][i]);
					_delay_us(100);
					HC595Write(imagee);
					_delay_us(100);
				}
			}
		}
	}
}
